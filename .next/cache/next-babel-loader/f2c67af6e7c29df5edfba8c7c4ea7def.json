{"ast":null,"code":"import connectDB from '../../../utils/connectDB';\nimport Users from '../../../models/userModel';\nimport auth from '../../../middleware/auth';\nimport bcrypt from 'bcrypt';\nconnectDB();\nexport default async (req, res) => {\n  switch (req.method) {\n    case \"PATCH\":\n      await resetPassword(req, res);\n      break;\n  }\n};\nconst resetPassword = async (req, res) => {\n  try {\n    const result = await auth(req, res);\n    const {\n      password\n    } = req.body;\n    const passwordHash = await bcrypt.hash(password, 12);\n    await Users.findOneAndUpdate({\n      _id: result.id\n    }, {\n      password: passwordHash\n    });\n    res.json({\n      msg: \"Update Success!\"\n    });\n  } catch (err) {\n    return res.status(500).json({\n      err: err.message\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"module"}