{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport Users from '../models/userModel';\nconst auth = async (req, res) => {\n  const token = req.headers.authorization;\n  if (!token) return res.status(400).json({\n    err: 'Invalid Authentication.'\n  });\n  const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET);\n  if (!decoded) return res.status(400).json({\n    err: 'Invalid Authentication.'\n  });\n  const user = await Users.findOne({\n    _id: decoded.id\n  });\n  return {\n    id: user._id,\n    role: user.role,\n    root: user.root\n  };\n};\nexport default auth;","map":{"version":3,"names":["jwt","Users","auth","req","res","token","headers","authorization","status","json","err","decoded","verify","process","env","ACCESS_TOKEN_SECRET","user","findOne","_id","id","role","root"],"sources":["/Users/sanjanaa/Documents/UrbanBasket/middleware/auth.js"],"sourcesContent":["import jwt from 'jsonwebtoken'\nimport Users from '../models/userModel'\n\n\nconst auth = async (req, res) => {\n    const token = req.headers.authorization;\n    if(!token) return res.status(400).json({err: 'Invalid Authentication.'})\n\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET)\n    if(!decoded) return res.status(400).json({err: 'Invalid Authentication.'})\n\n    const user = await Users.findOne({_id: decoded.id})\n\n    return {id: user._id, role: user.role, root: user.root};\n}\n\n\nexport default auth"],"mappings":"AAAA,OAAOA,GAAG,MAAM,cAAc;AAC9B,OAAOC,KAAK,MAAM,qBAAqB;AAGvC,MAAMC,IAAI,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EAC7B,MAAMC,KAAK,GAAGF,GAAG,CAACG,OAAO,CAACC,aAAa;EACvC,IAAG,CAACF,KAAK,EAAE,OAAOD,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAACC,GAAG,EAAE;EAAyB,CAAC,CAAC;EAExE,MAAMC,OAAO,GAAGX,GAAG,CAACY,MAAM,CAACP,KAAK,EAAEQ,OAAO,CAACC,GAAG,CAACC,mBAAmB,CAAC;EAClE,IAAG,CAACJ,OAAO,EAAE,OAAOP,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAACC,GAAG,EAAE;EAAyB,CAAC,CAAC;EAE1E,MAAMM,IAAI,GAAG,MAAMf,KAAK,CAACgB,OAAO,CAAC;IAACC,GAAG,EAAEP,OAAO,CAACQ;EAAE,CAAC,CAAC;EAEnD,OAAO;IAACA,EAAE,EAAEH,IAAI,CAACE,GAAG;IAAEE,IAAI,EAAEJ,IAAI,CAACI,IAAI;IAAEC,IAAI,EAAEL,IAAI,CAACK;EAAI,CAAC;AAC3D,CAAC;AAGD,eAAenB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module"}