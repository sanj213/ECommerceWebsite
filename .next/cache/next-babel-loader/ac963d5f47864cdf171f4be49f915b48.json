{"ast":null,"code":"import Head from 'next/head';\nimport { useContext, useState } from 'react';\nimport { DataContext } from '../store/GlobalState';\nimport { updateItem } from '../store/Actions';\nimport { postData, putData } from \"../utils/fetchData\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst Categories = () => {\n  const {\n    0: name,\n    1: setName\n  } = useState('');\n  const {\n    state,\n    dispatch\n  } = useContext(DataContext);\n  const {\n    categories,\n    auth\n  } = state;\n  const {\n    0: id,\n    1: setId\n  } = useState('');\n  const createCategory = async () => {\n    if (auth.user.role !== 'admin') return dispatch({\n      type: 'NOTIFY',\n      payload: {\n        error: 'Authentication is not vaild.'\n      }\n    });\n    if (!name) return dispatch({\n      type: 'NOTIFY',\n      payload: {\n        error: 'Name cannot be left blank.'\n      }\n    });\n    dispatch({\n      type: 'NOTIFY',\n      payload: {\n        loading: true\n      }\n    });\n    let res;\n    if (id) {\n      res = await putData(`categories/${id}`, {\n        name\n      }, auth.token);\n      if (res.err) return dispatch({\n        type: 'NOTIFY',\n        payload: {\n          error: res.err\n        }\n      });\n      dispatch(updateItem(categories, id, res.category, 'ADD_CATEGORIES'));\n    } else {\n      res = await postData('categories', {\n        name\n      }, auth.token);\n      if (res.err) return dispatch({\n        type: 'NOTIFY',\n        payload: {\n          error: res.err\n        }\n      });\n      dispatch({\n        type: \"ADD_CATEGORIES\",\n        payload: [...categories, res.newCategory]\n      });\n    }\n    setName('');\n    setId('');\n    return dispatch({\n      type: 'NOTIFY',\n      payload: {\n        success: res.msg\n      }\n    });\n  };\n  const handleEditCategory = catogory => {\n    setId(catogory._id);\n    setName(catogory.name);\n  };\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"col-md-6 mx-auto my-3\",\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Categories\"\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"input-group mb-3\",\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Add a new category\",\n        value: name,\n        onChange: e => setName(e.target.value)\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: \"btn btn-secondary ml-1\",\n        onClick: createCategory,\n        children: id ? \"Update\" : \"Create\"\n      })]\n    }), categories.map(catogory => /*#__PURE__*/_jsx(\"div\", {\n      className: \"card my-2 text-capitalize\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"card-body d-flex justify-content-between\",\n        children: [catogory.name, /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            cursor: 'pointer'\n          },\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"fas fa-edit mr-2 text-info\",\n            onClick: () => handleEditCategory(catogory)\n          }), /*#__PURE__*/_jsx(\"i\", {\n            className: \"fas fa-trash-alt text-danger\",\n            \"data-toggle\": \"modal\",\n            \"data-target\": \"#exampleModal\",\n            onClick: () => dispatch({\n              type: 'ADD_MODAL',\n              payload: [{\n                data: categories,\n                id: catogory._id,\n                title: catogory.name,\n                type: 'ADD_CATEGORIES'\n              }]\n            })\n          })]\n        })]\n      })\n    }, catogory._id))]\n  });\n};\nexport default Categories;","map":null,"metadata":{},"sourceType":"module"}